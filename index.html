<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DERA Residence - Complete Project Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .user-info {
            position: absolute;
            top: 20px;
            right: 30px;
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
            display: none;
            align-items: center;
            gap: 10px;
        }

        .sync-status {
            position: absolute;
            top: 20px;
            right: 250px;
            background: rgba(255,255,255,0.15);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85em;
            color: #ecf0f1;
            display: none;
            align-items: center;
            gap: 5px;
        }

        .sync-status.active {
            display: flex;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        .user-info {
            position: absolute;
            top: 20px;
            right: 30px;
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
            display: none;
            align-items: center;
            gap: 10px;
        }

        .user-info.active {
            display: flex;
        }

        .user-info .user-email {
            font-size: 0.9em;
        }

        .user-info .btn-logout {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: background 0.3s;
        }

        .user-info .btn-logout:hover {
            background: #c0392b;
        }

        .project-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }

        .summary-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .summary-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .tabs {
            display: flex;
            background: #ecf0f1;
            padding: 0 30px;
            overflow-x: auto;
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1em;
            color: #7f8c8d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab:hover {
            background: rgba(103, 126, 234, 0.1);
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: bold;
        }

        .tab-content {
            display: none;
            padding: 30px;
            max-height: calc(100vh - 400px);
            overflow-y: auto;
        }

        .tab-content.active {
            display: block;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        th.center {
            text-align: center;
        }

        th.right {
            text-align: right;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        td.center {
            text-align: center;
        }

        td.right {
            text-align: right;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        .total-row {
            background: #f8f9fa !important;
            font-weight: bold;
            font-size: 1.1em;
        }

        .total-row td {
            border-top: 2px solid #667eea;
        }

        .cost-cell {
            text-align: right;
            font-weight: 600;
            color: #27ae60;
        }

        .quantity-cell {
            text-align: center;
            font-weight: 600;
        }

        .section-header {
            background: #f8f9fa;
            padding: 15px 20px;
            margin: 30px 0 20px 0;
            border-left: 4px solid #667eea;
            border-radius: 5px;
        }

        .section-header h2 {
            color: #2c3e50;
            font-size: 1.8em;
        }

        .section-header p {
            color: #7f8c8d;
            margin-top: 5px;
        }

        /* Loading Overlay */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.3);
            border-top: 5px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Auth Modal */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .auth-modal.active {
            display: flex;
        }

        .auth-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            max-width: 450px;
            width: 90%;
        }

        .auth-box h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            text-align: center;
        }

        .auth-box p {
            color: #7f8c8d;
            text-align: center;
            margin-bottom: 20px;
        }

        .auth-links {
            text-align: center;
            margin-top: 20px;
        }

        .auth-links a {
            color: #667eea;
            cursor: pointer;
            text-decoration: none;
            font-size: 0.9em;
        }

        .auth-links a:hover {
            text-decoration: underline;
        }

        .auth-error {
            background: #ffe6e6;
            border-left: 4px solid #e74c3c;
            padding: 12px;
            margin-bottom: 20px;
            border-radius: 5px;
            color: #c0392b;
            display: none;
        }

        .auth-error.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 100%;
            justify-content: center;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #229954;
        }

        .btn-info {
            background: #3498db;
            color: white;
        }

        .btn-info:hover {
            background: #2980b9;
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn-warning:hover {
            background: #e67e22;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .auth-links {
            text-align: center;
            margin-top: 20px;
        }

        .auth-links a {
            color: #667eea;
            cursor: pointer;
            text-decoration: none;
        }

        .auth-links a:hover {
            text-decoration: underline;
        }

        .auth-error {
            background: #ffe6e6;
            border-left: 4px solid #e74c3c;
            padding: 12px;
            margin-bottom: 20px;
            border-radius: 5px;
            color: #c0392b;
            display: none;
        }

        .auth-error.active {
            display: block;
        }

        /* Project Management Styles (from dera-residence-cloud.html) */
        .task-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .task-table th {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 12px;
            text-align: left;
            font-size: 0.9em;
            text-transform: uppercase;
        }

        .task-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #ddd;
        }

        .task-row {
            transition: background 0.2s;
        }

        .task-row:hover {
            background: #f8f9fa;
        }

        .task-row.section {
            background: #e8f4f8;
            font-weight: bold;
        }

        .task-row.completed {
            background: #d4edda;
        }

        .task-row.completed .task-name {
            text-decoration: line-through;
            opacity: 0.7;
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .task-notes {
            width: 100%;
            min-height: 60px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: inherit;
            resize: vertical;
        }

        .task-notes:focus {
            outline: none;
            border-color: #3498db;
        }

        .save-notes-btn {
            margin-top: 5px;
            padding: 6px 12px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
        }

        .save-notes-btn:hover {
            background: #2980b9;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: bold;
            text-transform: uppercase;
        }

        .badge-milestone {
            background: #f39c12;
            color: white;
        }

        .badge-critical {
            background: #e74c3c;
            color: white;
        }

        .badge-standard {
            background: #3498db;
            color: white;
        }

        .progress-bar-container {
            width: 100%;
            height: 24px;
            background: #ecf0f1;
            border-radius: 12px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.85em;
            transition: width 0.3s ease;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .tabs {
                padding: 0 10px;
            }
            
            .tab {
                padding: 12px 15px;
                font-size: 0.9em;
            }
            
            .tab-content {
                padding: 15px;
            }
            
            .project-summary {
                grid-template-columns: 1fr;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Authentication Modal -->
    <div class="auth-modal active" id="authModal">
        <div class="auth-box">
            <h2>üèóÔ∏è DERA Residence</h2>
            <p>Sign in to access your project data</p>

            <div class="auth-error" id="authError"></div>

            <div class="auth-links" style="margin-bottom: 20px;">
                <button class="btn btn-primary" style="margin-bottom: 10px;" onclick="showLogin()">Sign In</button>
                <button class="btn btn-secondary" onclick="showSignup()">Create Account</button>
            </div>

            <!-- Login Form -->
            <div id="loginForm" style="display: none;">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" required placeholder="Enter password">
                </div>
                <button class="btn btn-primary" onclick="loginUser()">Sign In</button>
                <div class="auth-links" style="margin-top: 15px;">
                    <a onclick="showSignup()">Don't have an account? Sign Up</a>
                </div>
            </div>

            <!-- Register Form -->
            <div id="signupForm" style="display: none;">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="signupEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="signupPassword" required placeholder="Min 6 characters" minlength="6">
                </div>
                <div class="form-group">
                    <label>Confirm Password</label>
                    <input type="password" id="signupPasswordConfirm" required placeholder="Confirm password">
                </div>
                <button class="btn btn-primary" onclick="signupUser()">Create Account</button>
                <div class="auth-links" style="margin-top: 15px;">
                    <a onclick="showLogin()">Already have an account? Sign In</a>
                </div>
            </div>
        </div>
    </div>

    <div class="container" id="mainContainer" style="display: none;">
        <div class="header">
            <h1>üè† DERA Residence - 791 110th Ave N, Naples, FL</h1>
            <p>Complete Project Management System - Cloud Enabled</p>
            <div class="sync-status" id="syncIndicator">‚òÅÔ∏è Auto-sync enabled</div>
            <div class="user-info" id="userInfo">
                <span class="user-email" id="userEmail"></span>
                <button class="btn-logout" onclick="logout()">Logout</button>
            </div>
        </div>

        <div class="project-summary">
            <div class="summary-card">
                <h3>Total Budget</h3>
                <div class="value">$697,835</div>
            </div>
            <div class="summary-card">
                <h3>Project Timeline</h3>
                <div class="value">26 Weeks</div>
            </div>
            <div class="summary-card">
                <h3>Start Date</h3>
                <div class="value">Feb 15, 2025</div>
            </div>
            <div class="summary-card">
                <h3>Completion</h3>
                <div class="value">Aug 2025</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('overview')">Project Overview</button>
            <button class="tab" onclick="showTab('detailed-plan')">üìä Detailed Project Plan</button>
            <button class="tab" onclick="showTab('demolition')">Demolition & Site Work</button>
            <button class="tab" onclick="showTab('foundation')">Foundation</button>
            <button class="tab" onclick="showTab('structure')">Structural</button>
            <button class="tab" onclick="showTab('framing')">Framing</button>
            <button class="tab" onclick="showTab('exterior')">Exterior</button>
            <button class="tab" onclick="showTab('mep')">MEP Systems</button>
            <button class="tab" onclick="showTab('finishes')">Interior Finishes</button>
            <button class="tab" onclick="showTab('pool')">Pool & Outdoor</button>
            <button class="tab" onclick="showTab('bids')">Bid Tracking</button>
            <button class="tab" onclick="showTab('tile')">Tile Calculator</button>
            <button class="tab" onclick="showTab('contractors')">Contractor Organizer</button>
        </div>

        <!-- PROJECT OVERVIEW TAB -->
        <div id="overview" class="tab-content active">
            <div class="section-header">
                <h2>Complete Project Cost Breakdown</h2>
                <p>5% Savings Version - Value Optimized</p>
            </div>
            
            <div style="background: #D4EDDA; border-left: 5px solid #28A745; padding: 20px; margin: 20px 0; border-radius: 5px;">
                <h3 style="color: #155724; margin: 0 0 15px 0;">üí∞ 5% SAVINGS VERSION - VALUE OPTIMIZED</h3>
                <p style="margin: 5px 0;"><strong>Total Project Cost: $697,835</strong> (Saved $36,999 from original $734,834)</p>
                <p style="margin: 5px 0; font-size: 0.95em;">Strategic value engineering across all trades while maintaining quality and code compliance</p>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Phase</th>
                        <th>Category</th>
                        <th class="right">Original Cost</th>
                        <th class="right">Optimized Cost</th>
                        <th class="right">Savings</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Permits & Pre-Construction</td>
                        <td class="cost-cell">$20,500</td>
                        <td class="cost-cell">$20,500</td>
                        <td class="cost-cell">$0</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Demolition & Site Work</td>
                        <td class="cost-cell">$33,500</td>
                        <td class="cost-cell">$31,800</td>
                        <td class="cost-cell">$1,700</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Grading & Fill Work</td>
                        <td class="cost-cell">$8,000</td>
                        <td class="cost-cell">$8,000</td>
                        <td class="cost-cell">$0</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Foundation</td>
                        <td class="cost-cell">$46,500</td>
                        <td class="cost-cell">$44,150</td>
                        <td class="cost-cell">$2,350</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Structure (CMU & Concrete)</td>
                        <td class="cost-cell">$90,090</td>
                        <td class="cost-cell">$85,585</td>
                        <td class="cost-cell">$4,505</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Framing</td>
                        <td class="cost-cell">$123,250</td>
                        <td class="cost-cell">$117,090</td>
                        <td class="cost-cell">$6,160</td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>MEP Systems</td>
                        <td class="cost-cell">$122,925</td>
                        <td class="cost-cell">$116,800</td>
                        <td class="cost-cell">$6,125</td>
                    </tr>
                    <tr>
                        <td>8</td>
                        <td>Exterior Systems</td>
                        <td class="cost-cell">$110,250</td>
                        <td class="cost-cell">$104,740</td>
                        <td class="cost-cell">$5,510</td>
                    </tr>
                    <tr>
                        <td>9</td>
                        <td>Interior Finishes</td>
                        <td class="cost-cell">$135,319</td>
                        <td class="cost-cell">$128,670</td>
                        <td class="cost-cell">$6,649</td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>Pool & Outdoor Features</td>
                        <td class="cost-cell">$44,500</td>
                        <td class="cost-cell">$42,500</td>
                        <td class="cost-cell">$2,000</td>
                    </tr>
                    <tr>
                        <td>11</td>
                        <td>Final Details & Contingency</td>
                        <td class="cost-cell">$0</td>
                        <td class="cost-cell">$0</td>
                        <td class="cost-cell">$0</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="2"><strong>TOTAL PROJECT COST</strong></td>
                        <td class="cost-cell">$734,834</td>
                        <td class="cost-cell">$697,835</td>
                        <td class="cost-cell" style="color: #27ae60; font-size: 1.2em;">$36,999</td>
                    </tr>
                </tfoot>
            </table>

            <div style="background: #E8F4F8; border-left: 5px solid #3498DB; padding: 20px; margin: 30px 0; border-radius: 5px;">
                <h3 style="color: #2C3E50; margin: 0 0 15px 0;">üìã Key Savings Strategies</h3>
                <ul style="margin-left: 20px; line-height: 1.8;">
                    <li><strong>Material Optimization:</strong> Competitive pricing on lumber, CMU blocks, and concrete</li>
                    <li><strong>Labor Efficiency:</strong> Streamlined scheduling and combined trade work</li>
                    <li><strong>Value Engineering:</strong> Smart substitutions without compromising quality</li>
                    <li><strong>Bulk Purchasing:</strong> Volume discounts on materials</li>
                    <li><strong>Code Compliance:</strong> All savings maintain full Florida Building Code compliance</li>
                </ul>
            </div>
        </div>

        <!-- DETAILED PROJECT PLAN TAB (Full Cloud-Enabled Version) -->
        <div id="detailed-plan" class="tab-content">
            <div class="section-header">
                <h2>Detailed Project Plan - Cloud-Enabled</h2>
                <p>Complete Firebase-integrated project management system with contractor tracking and variance analysis</p>
            </div>
            
            <div style="background: #E8F4F8; border-left: 5px solid #3498DB; padding: 30px; margin: 20px 0; border-radius: 5px; text-align: center;">
                <h3 style="color: #2C3E50; margin: 0 0 20px 0;">üìä Advanced Project Management System</h3>
                <p style="margin-bottom: 25px; font-size: 1.1em;">Complete task-by-task tracking with contractor quotes, variance analysis, and real-time cloud sync</p>
                <a href="detailed-project-plan-standalone.html" target="_blank" class="btn btn-primary" style="display: inline-flex; text-decoration: none; font-size: 1.1em; padding: 15px 30px;">
                    Open Detailed Project Plan ‚Üí
                </a>
            </div>

            <div style="margin: 30px 0;">
                <h3 style="color: #2c3e50; margin-bottom: 15px;">Key Features</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #3498db;">
                        <h4 style="color: #3498db; margin-bottom: 10px;">‚òÅÔ∏è Cloud Sync</h4>
                        <p style="color: #666; line-height: 1.6;">Auto-save every 30 seconds with Firebase backend. Access your data from any device, anywhere.</p>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #27ae60;">
                        <h4 style="color: #27ae60; margin-bottom: 10px;">üí∞ Budget Tracking</h4>
                        <p style="color: #666; line-height: 1.6;">Track contractor quotes vs budget with real-time variance calculations and visual indicators.</p>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #e74c3c;">
                        <h4 style="color: #e74c3c; margin-bottom: 10px;">üìã Complete Task List</h4>
                        <p style="color: #666; line-height: 1.6;">70+ tasks across 14 major phases with dates, durations, and milestone tracking.</p>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #f39c12;">
                        <h4 style="color: #f39c12; margin-bottom: 10px;">üîê Secure Authentication</h4>
                        <p style="color: #666; line-height: 1.6;">Email/password or Google sign-in with Firebase Authentication. Your data is private and secure.</p>
                    </div>
                </div>
            </div>

            <div style="margin: 30px 0;">
                <h3 style="color: #2c3e50; margin-bottom: 15px;">Project Phases</h3>
                <ul style="list-style: none; padding: 0;">
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 1:</strong> Preconstruction Planning (26 days, $15,000)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 2:</strong> Permits & Approvals (18 days, $5,500)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 3:</strong> Demolition & Site Work (15 days, $31,800)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 4:</strong> Grading & Fill Work (26 days, $8,000)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 5:</strong> Foundation (30 days, $44,150)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 6:</strong> Structure - CMU Walls & Columns (26 days, $85,585)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 7:</strong> Framing (47 days, $117,090)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 8:</strong> MEP Rough-Ins (18 days, $116,800)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 9:</strong> Pool & Outdoor Features (67 days, $42,500)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 10:</strong> Insulation & Drywall (36 days, $45,500)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 11:</strong> Exterior Finishes (45 days, $86,060)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 12:</strong> Interior Finishes (61 days, $154,050)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 13:</strong> MEP Final Trim & Fixtures (15 days, $20,550)
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Phase 14:</strong> Final Inspections & Completion (38 days, $13,100)
                    </li>
                </ul>
            </div>

            <div style="background: #FFF3CD; border-left: 5px solid #F39C12; padding: 20px; margin: 30px 0; border-radius: 5px;">
                <h3 style="color: #856404; margin: 0 0 15px 0;">üìù How to Use</h3>
                <ol style="margin-left: 20px; line-height: 1.8; color: #856404;">
                    <li>Click "Open Detailed Project Plan" button above</li>
                    <li>Create an account or sign in with Google</li>
                    <li>Enter contractor names and quotes for each task</li>
                    <li>System automatically calculates variances and totals</li>
                    <li>Data auto-syncs every 30 seconds to cloud</li>
                    <li>Export to CSV anytime for backup or analysis</li>
                </ol>
            </div>
        </div>

        <!-- DEMOLITION & SITE WORK TAB -->
        <div id="demolition" class="tab-content">
            <div class="section-header">
                <h2>Demolition & Site Work</h2>
                <p>Phase 3 - Site Preparation</p>
            </div>
            <p><strong>Duration:</strong> 15 days (Apr 1 - Apr 15)</p>
            <p><strong>Budget:</strong> $31,800</p>
            <p><strong>Critical Path:</strong> Final Demolition Inspection (Apr 15)</p>

            <h3 style="margin-top: 30px;">Scope of Work</h3>
            <table>
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Duration</th>
                        <th>Cost</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Demolition of Existing Structure</td>
                        <td>12 days</td>
                        <td class="cost-cell">$17,000</td>
                        <td>Complete tear-down and debris removal</td>
                    </tr>
                    <tr>
                        <td>Site Preparation & Grading</td>
                        <td>12 days</td>
                        <td class="cost-cell">$6,800</td>
                        <td>Initial site leveling</td>
                    </tr>
                    <tr>
                        <td>Controlled Fill (95% Compaction)</td>
                        <td>12 days</td>
                        <td class="cost-cell">$8,000</td>
                        <td>Engineered fill with compaction testing</td>
                    </tr>
                    <tr>
                        <td>Final Demolition Inspection</td>
                        <td>1 day</td>
                        <td class="cost-cell">$0</td>
                        <td>County inspection - REQUIRED</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td><strong>TOTAL</strong></td>
                        <td>15 days</td>
                        <td class="cost-cell">$31,800</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- FOUNDATION TAB -->
        <div id="foundation" class="tab-content">
            <div class="section-header">
                <h2>Foundation Work</h2>
                <p>Phase 5 - Slab Foundation</p>
            </div>
            <p><strong>Duration:</strong> 30 days (May 15 - Jun 13)</p>
            <p><strong>Budget:</strong> $44,150</p>
            <p><strong>Critical Inspections:</strong> Foundation Inspection (Jun 4), Spot Survey (Jun 13)</p>

            <h3 style="margin-top: 30px;">Foundation Specifications</h3>
            <ul style="margin-left: 20px; line-height: 1.8;">
                <li>Monolithic slab foundation with integrated grade beams</li>
                <li>4" slab thickness with 3000 PSI concrete minimum</li>
                <li>Grade 60 rebar per structural plans</li>
                <li>Vapor barrier and termite treatment</li>
                <li>Under-slab plumbing and electrical conduits</li>
            </ul>

            <table style="margin-top: 30px;">
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Duration</th>
                        <th>Cost</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Foundation Layout & Under-Slab Utilities</td>
                        <td>17 days</td>
                        <td class="cost-cell">$15,000</td>
                        <td>Site preparation and utility placement</td>
                    </tr>
                    <tr>
                        <td>Foundation Inspection (BEFORE POUR)</td>
                        <td>1 day</td>
                        <td class="cost-cell">$0</td>
                        <td>CRITICAL - Must pass before concrete pour</td>
                    </tr>
                    <tr>
                        <td>Pour Foundation Slab</td>
                        <td>1 day</td>
                        <td class="cost-cell">$25,000</td>
                        <td>Concrete placement and finishing</td>
                    </tr>
                    <tr>
                        <td>Concrete Curing & Form Removal</td>
                        <td>7 days</td>
                        <td class="cost-cell">$0</td>
                        <td>Minimum cure time required</td>
                    </tr>
                    <tr>
                        <td>Foundation Spot Survey (DEADLINE)</td>
                        <td>1 day</td>
                        <td class="cost-cell">$4,150</td>
                        <td>Required for elevation verification</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td><strong>TOTAL</strong></td>
                        <td>30 days</td>
                        <td class="cost-cell">$44,150</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- STRUCTURAL TAB -->
        <div id="structure" class="tab-content">
            <div class="section-header">
                <h2>Structural - CMU Walls & Columns</h2>
                <p>Phase 6 - Masonry Construction</p>
            </div>
            <p><strong>Duration:</strong> 26 days (Jun 16 - Jul 11)</p>
            <p><strong>Budget:</strong> $85,585</p>

            <h3 style="margin-top: 30px;">CMU Specifications</h3>
            <ul style="margin-left: 20px; line-height: 1.8;">
                <li>8" CMU blocks for exterior walls (High Velocity Hurricane Zone rated)</li>
                <li>Vertical and horizontal rebar per engineer specifications</li>
                <li>Grouted cells at 16" on center minimum</li>
                <li>Hurricane ties and anchoring systems</li>
                <li>Concrete columns at structural points</li>
            </ul>

            <table style="margin-top: 30px;">
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Duration</th>
                        <th>Cost</th>
                        <th>Quantity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>First Floor CMU Walls</td>
                        <td>15 days</td>
                        <td class="cost-cell">$59,205</td>
                        <td>~3,200 SF of wall area</td>
                    </tr>
                    <tr>
                        <td>Concrete Columns & Beams</td>
                        <td>19 days</td>
                        <td class="cost-cell">$26,380</td>
                        <td>Structural support system</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td><strong>TOTAL</strong></td>
                        <td>26 days</td>
                        <td class="cost-cell">$85,585</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- FRAMING TAB -->
        <div id="framing" class="tab-content">
            <div class="section-header">
                <h2>Framing - Wood Frame Construction</h2>
                <p>Phase 7 - Floors, Walls, Roof</p>
            </div>
            <p><strong>Duration:</strong> 47 days (Jun 16 - Aug 1)</p>
            <p><strong>Budget:</strong> $117,090</p>

            <table>
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Duration</th>
                        <th>Cost</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>First Floor Wall Framing</td>
                        <td>26 days</td>
                        <td class="cost-cell">$45,000</td>
                        <td>Interior wall framing, 2x4 and 2x6 studs</td>
                    </tr>
                    <tr>
                        <td>Second Floor & Roof Framing</td>
                        <td>14 days</td>
                        <td class="cost-cell">$52,090</td>
                        <td>Engineered floor joists and roof trusses</td>
                    </tr>
                    <tr>
                        <td>House Wrap & Dry-In (Weather-Tight)</td>
                        <td>7 days</td>
                        <td class="cost-cell">$20,000</td>
                        <td>Building envelope protection</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td><strong>TOTAL</strong></td>
                        <td>47 days</td>
                        <td class="cost-cell">$117,090</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- EXTERIOR TAB -->
        <div id="exterior" class="tab-content">
            <div class="section-header">
                <h2>Exterior Systems</h2>
                <p>Roofing, Windows, Doors, Siding</p>
            </div>
            <p><strong>Budget:</strong> $104,740</p>

            <table>
                <thead>
                    <tr>
                        <th>System</th>
                        <th>Cost</th>
                        <th>Specifications</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Roofing System</td>
                        <td class="cost-cell">$35,600</td>
                        <td>Architectural shingles, High Wind rated</td>
                    </tr>
                    <tr>
                        <td>Windows & Doors</td>
                        <td class="cost-cell">$42,140</td>
                        <td>Impact-resistant, High Velocity Hurricane Zone</td>
                    </tr>
                    <tr>
                        <td>Exterior Finishes</td>
                        <td class="cost-cell">$27,000</td>
                        <td>Stucco/siding, trim, soffit, fascia</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td><strong>TOTAL</strong></td>
                        <td class="cost-cell">$104,740</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- MEP SYSTEMS TAB -->
        <div id="mep" class="tab-content">
            <div class="section-header">
                <h2>MEP Systems</h2>
                <p>Electrical, Plumbing, HVAC</p>
            </div>
            <p><strong>Duration:</strong> 18 days (Jul 28 - Aug 14)</p>
            <p><strong>Budget:</strong> $116,800</p>
            <p><strong>Major Milestone:</strong> Framing Inspection (Aug 14)</p>

            <table>
                <thead>
                    <tr>
                        <th>System</th>
                        <th>Duration</th>
                        <th>Cost</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Electrical Rough-In</td>
                        <td>12 days</td>
                        <td class="cost-cell">$35,600</td>
                        <td>Complete electrical system, 200A service</td>
                    </tr>
                    <tr>
                        <td>Plumbing Rough-In</td>
                        <td>12 days</td>
                        <td class="cost-cell">$41,100</td>
                        <td>All supply and waste lines</td>
                    </tr>
                    <tr>
                        <td>HVAC Rough-In</td>
                        <td>12 days</td>
                        <td class="cost-cell">$40,100</td>
                        <td>Ductwork and equipment placement</td>
                    </tr>
                    <tr>
                        <td>All Rough-In Inspections</td>
                        <td>1 day</td>
                        <td class="cost-cell">$0</td>
                        <td>CRITICAL - All trades must pass</td>
                    </tr>
                    <tr>
                        <td>‚úÖ Framing Inspection - MAJOR MILESTONE</td>
                        <td>1 day</td>
                        <td class="cost-cell">$0</td>
                        <td>Required before proceeding</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td><strong>TOTAL</strong></td>
                        <td>18 days</td>
                        <td class="cost-cell">$116,800</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- INTERIOR FINISHES TAB -->
        <div id="finishes" class="tab-content">
            <div class="section-header">
                <h2>Interior Finishes</h2>
                <p>Drywall, Flooring, Kitchen, Bathrooms</p>
            </div>
            <p><strong>Budget:</strong> $128,670</p>

            <table>
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Cost</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Drywall & Insulation</td>
                        <td class="cost-cell">$28,500</td>
                        <td>Complete drywall installation, Level 4 finish</td>
                    </tr>
                    <tr>
                        <td>Flooring</td>
                        <td class="cost-cell">$35,670</td>
                        <td>Tile, hardwood, carpet per selections</td>
                    </tr>
                    <tr>
                        <td>Kitchen Cabinets & Countertops</td>
                        <td class="cost-cell">$28,000</td>
                        <td>Custom cabinetry, granite/quartz counters</td>
                    </tr>
                    <tr>
                        <td>Bathroom Finishes</td>
                        <td class="cost-cell">$18,500</td>
                        <td>Vanities, fixtures, tile work</td>
                    </tr>
                    <tr>
                        <td>Interior Doors & Trim</td>
                        <td class="cost-cell">$12,000</td>
                        <td>All interior doors, baseboard, casing</td>
                    </tr>
                    <tr>
                        <td>Paint & Final Touches</td>
                        <td class="cost-cell">$6,000</td>
                        <td>Complete interior paint, finishing</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td><strong>TOTAL</strong></td>
                        <td class="cost-cell">$128,670</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- POOL & OUTDOOR TAB -->
        <div id="pool" class="tab-content">
            <div class="section-header">
                <h2>Pool & Outdoor Features</h2>
                <p>Pool, Deck, Landscaping</p>
            </div>
            <p><strong>Duration:</strong> 67 days (Jun 23 - Aug 28)</p>
            <p><strong>Budget:</strong> $42,500</p>

            <table>
                <thead>
                    <tr>
                        <th>Feature</th>
                        <th>Cost</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Pool Construction</td>
                        <td class="cost-cell">$32,000</td>
                        <td>Gunite pool with standard finishes</td>
                    </tr>
                    <tr>
                        <td>Pool Equipment</td>
                        <td class="cost-cell">$6,500</td>
                        <td>Pump, filter, heater, automation</td>
                    </tr>
                    <tr>
                        <td>Deck & Patio</td>
                        <td class="cost-cell">$8,000</td>
                        <td>Pavers or concrete deck</td>
                    </tr>
                    <tr>
                        <td>Landscaping</td>
                        <td class="cost-cell">$4,000</td>
                        <td>Basic landscaping package</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td><strong>TOTAL</strong></td>
                        <td class="cost-cell">$42,500</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- BID TRACKING TAB -->
        <div id="bids" class="tab-content">
            <div class="section-header">
                <h2>Bid Tracking & Contractor Selection</h2>
                <p>Compare quotes and manage contractor relationships</p>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="addBidModal()">+ Add New Bid</button>
                <button class="btn btn-success" onclick="exportBids()">üìä Export Bids</button>
            </div>

            <div id="bidsList">
                <h3 style="margin: 30px 0 15px 0;">Active Bids</h3>
                <p style="color: #7f8c8d;">Use the Contractor Organizer tab to find contractors and request quotes.</p>
            </div>
        </div>

        <!-- TILE CALCULATOR TAB -->
        <div id="tile" class="tab-content">
            <div class="section-header">
                <h2>Tile Calculator</h2>
                <p>Calculate tile requirements for interior finishes</p>
            </div>
            
            <div style="background: #E8F4F8; border-left: 5px solid #3498DB; padding: 30px; margin: 20px 0; border-radius: 5px; text-align: center;">
                <h3 style="color: #2C3E50; margin: 0 0 20px 0;">üìê Interior Tile Planning Tool</h3>
                <p style="margin-bottom: 25px; font-size: 1.1em;">Complete tile calculations with waste factors and retailer pricing guide</p>
                <a href="tile-calculator.html" target="_blank" class="btn btn-primary" style="display: inline-flex; text-decoration: none; font-size: 1.1em; padding: 15px 30px;">
                    Open Tile Calculator ‚Üí
                </a>
            </div>

            <div style="margin: 30px 0;">
                <h3 style="color: #2c3e50; margin-bottom: 15px;">Quick Summary</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div class="summary-card">
                        <h3>Total Square Footage</h3>
                        <div class="value" style="font-size: 1.5em;">9,011 SF</div>
                    </div>
                    <div class="summary-card">
                        <h3>With Waste Factor</h3>
                        <div class="value" style="font-size: 1.5em;">10,026 SF</div>
                    </div>
                    <div class="summary-card">
                        <h3>Tile Types</h3>
                        <div class="value" style="font-size: 1.5em;">16 Different</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONTRACTOR ORGANIZER TAB -->
        <div id="contractors" class="tab-content">
            <div class="section-header">
                <h2>Contractor Directory</h2>
                <p>Southwest Florida Contractors Database - 186+ Contractors</p>
            </div>
            
            <div style="background: #E8F4F8; border-left: 5px solid #3498DB; padding: 30px; margin: 20px 0; border-radius: 5px; text-align: center;">
                <h3 style="color: #2C3E50; margin: 0 0 20px 0;">üèóÔ∏è Complete Contractor Management System</h3>
                <p style="margin-bottom: 25px; font-size: 1.1em;">Browse 186+ contractors across 22 categories with contact information, bid tracking, and mass email capabilities</p>
                <a href="contractor-organizer.html" target="_blank" class="btn btn-primary" style="display: inline-flex; text-decoration: none; font-size: 1.1em; padding: 15px 30px;">
                    Open Contractor Organizer ‚Üí
                </a>
            </div>

            <div style="margin: 30px 0;">
                <h3 style="color: #2c3e50; margin-bottom: 15px;">Key Features</h3>
                <ul style="list-style: none; padding: 0;">
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>22 Trade Categories:</strong> Electrical, Plumbing, HVAC, Framing, Roofing, and more
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Complete Contact Info:</strong> Phone, email, address, license numbers
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Bid Tracking:</strong> Request and compare quotes from multiple contractors
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Mass Email:</strong> Contact multiple contractors simultaneously
                    </li>
                    <li style="padding: 10px; background: #f8f9fa; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                        ‚úì <strong>Search & Filter:</strong> Find contractors by specialty, location, or name
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-box">
            <div class="auth-error" id="authError"></div>
            
            <div id="loginForm">
                <h2>üîê Login to DERA Project</h2>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter password">
                </div>
                <button class="btn btn-primary" onclick="loginUser()">Login</button>
                <div class="auth-links">
                    <p>Don't have an account? <a onclick="showSignup()">Sign Up</a></p>
                </div>
            </div>

            <div id="signupForm" style="display: none;">
                <h2>üìù Create Account</h2>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="signupEmail" placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="signupPassword" placeholder="Minimum 6 characters">
                </div>
                <div class="form-group">
                    <label>Confirm Password</label>
                    <input type="password" id="signupPasswordConfirm" placeholder="Re-enter password">
                </div>
                <button class="btn btn-primary" onclick="signupUser()">Create Account</button>
                <div class="auth-links">
                    <p>Already have an account? <a onclick="showLogin()">Login</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBXUuaY9QCVxgXynWKzBdM91a2QiNZVQi0",
            authDomain: "naples-791-build.firebaseapp.com",
            projectId: "naples-791-build",
            storageBucket: "naples-791-build.firebasestorage.app",
            messagingSenderId: "307309540602",
            appId: "1:307309540602:web:735cb7a476a356a6d7c543"
        };

        // Initialize Firebase
        let app, auth, db;
        let currentUser = null;

        try {
            app = firebase.initializeApp(firebaseConfig);
            auth = firebase.auth();
            db = firebase.firestore();
            console.log('Firebase initialized successfully');
        } catch (error) {
            console.error('Firebase initialization error:', error);
        }

        // Project Data
        const projectData = [
            { wbs: '1', task: 'PRECONSTRUCTION PLANNING', type: 'MILESTONE', start: 'Feb 15', end: 'Mar 12', days: 26, budget: 15000, isSection: true, completed: false, notes: '' },
            { wbs: '1.1', task: 'Finalize Architectural & Engineering Plans', type: 'CRITICAL', start: 'Feb 15', end: 'Mar 1', days: 15, budget: 8000, completed: false, notes: '' },
            { wbs: '1.2', task: 'Conduct Property Survey', type: 'CRITICAL', start: 'Mar 1', end: 'Mar 5', days: 5, budget: 2500, completed: false, notes: '' },
            { wbs: '1.3', task: 'Prepare Permit Application Package', type: 'CRITICAL', start: 'Mar 5', end: 'Mar 10', days: 6, budget: 1500, completed: false, notes: '' },
            { wbs: '1.4', task: 'Submit All Permit Applications', type: 'CRITICAL', start: 'Mar 12', end: 'Mar 14', days: 3, budget: 3000, completed: false, notes: '' },
            
            { wbs: '2', task: 'PERMITS & APPROVALS', type: 'CRITICAL', start: 'Mar 14', end: 'Mar 31', days: 18, budget: 5500, isSection: true, completed: false, notes: '' },
            { wbs: '2.1', task: 'Building Permit Plan Review', type: 'CRITICAL', start: 'Mar 14', end: 'Mar 26', days: 13, budget: 2000, completed: false, notes: '' },
            { wbs: '2.2', task: '‚úÖ Receive Building Permit Approval', type: 'MILESTONE', start: 'Mar 27', end: 'Mar 27', days: 1, budget: 0, completed: false, notes: '' },
            { wbs: '2.3', task: 'Record Notice of Commencement', type: 'CRITICAL', start: 'Mar 29', end: 'Mar 31', days: 3, budget: 3500, completed: false, notes: '' },
            
            { wbs: '3', task: 'DEMOLITION & SITE WORK', type: 'STANDARD', start: 'Apr 1', end: 'Apr 15', days: 15, budget: 31800, isSection: true, completed: false, notes: '' },
            { wbs: '3.1', task: 'Demolition of Existing Structure', type: 'STANDARD', start: 'Apr 1', end: 'Apr 12', days: 12, budget: 17000, completed: false, notes: '' },
            { wbs: '3.2', task: 'Site Preparation & Grading', type: 'STANDARD', start: 'Apr 1', end: 'Apr 12', days: 12, budget: 6800, completed: false, notes: '' },
            { wbs: '3.3', task: 'Controlled Fill (95% Compaction)', type: 'STANDARD', start: 'Apr 1', end: 'Apr 12', days: 12, budget: 8000, completed: false, notes: '' },
            { wbs: '3.4', task: 'Final Demolition Inspection', type: 'CRITICAL', start: 'Apr 15', end: 'Apr 15', days: 1, budget: 0, completed: false, notes: '' },
            
            { wbs: '4', task: 'GRADING & FILL WORK', type: 'STANDARD', start: 'Apr 19', end: 'May 14', days: 26, budget: 8000, isSection: true, completed: false, notes: '' },
            { wbs: '4.1', task: 'Site Stakeout & Preparation', type: 'STANDARD', start: 'Apr 19', end: 'Apr 20', days: 2, budget: 0, completed: false, notes: '' },
            { wbs: '4.2', task: 'Initial Grading Inspection', type: 'CRITICAL', start: 'Apr 19', end: 'Apr 19', days: 1, budget: 0, completed: false, notes: '' },
            { wbs: '4.3', task: 'Fill & Compact to 4 Ft Elevation', type: 'STANDARD', start: 'Apr 20', end: 'May 14', days: 25, budget: 8000, completed: false, notes: '' },
            { wbs: '4.4', task: 'Final Grading Inspection', type: 'CRITICAL', start: 'May 14', end: 'May 14', days: 1, budget: 0, completed: false, notes: '' },
            
            { wbs: '5', task: 'FOUNDATION', type: 'STANDARD', start: 'May 15', end: 'Jun 13', days: 30, budget: 44150, isSection: true, completed: false, notes: '' },
            { wbs: '5.1', task: 'Foundation Layout & Under-Slab Utilities', type: 'STANDARD', start: 'May 15', end: 'May 31', days: 17, budget: 15000, completed: false, notes: '' },
            { wbs: '5.2', task: 'Foundation Inspection (BEFORE POUR)', type: 'CRITICAL', start: 'Jun 4', end: 'Jun 4', days: 1, budget: 0, completed: false, notes: '' },
            { wbs: '5.3', task: 'Pour Foundation Slab', type: 'STANDARD', start: 'Jun 5', end: 'Jun 5', days: 1, budget: 25000, completed: false, notes: '' },
            { wbs: '5.4', task: 'Concrete Curing & Form Removal', type: 'STANDARD', start: 'Jun 6', end: 'Jun 12', days: 7, budget: 0, completed: false, notes: '' },
            { wbs: '5.5', task: 'Foundation Spot Survey (DEADLINE)', type: 'CRITICAL', start: 'Jun 13', end: 'Jun 13', days: 1, budget: 4150, completed: false, notes: '' },
            
            { wbs: '6', task: 'STRUCTURE (CMU WALLS & COLUMNS)', type: 'STANDARD', start: 'Jun 16', end: 'Jul 11', days: 26, budget: 85585, isSection: true, completed: false, notes: '' },
            { wbs: '6.1', task: 'First Floor CMU Walls', type: 'STANDARD', start: 'Jun 16', end: 'Jun 30', days: 15, budget: 59205, completed: false, notes: '' },
            { wbs: '6.2', task: 'Concrete Columns & Beams', type: 'STANDARD', start: 'Jun 23', end: 'Jul 11', days: 19, budget: 26380, completed: false, notes: '' },
            
            { wbs: '7', task: 'FRAMING (FLOORS, WALLS, ROOF)', type: 'STANDARD', start: 'Jun 16', end: 'Aug 1', days: 47, budget: 117090, isSection: true, completed: false, notes: '' },
            { wbs: '7.1', task: 'First Floor Wall Framing', type: 'STANDARD', start: 'Jun 16', end: 'Jul 11', days: 26, budget: 45000, completed: false, notes: '' },
            { wbs: '7.2', task: 'Second Floor & Roof Framing', type: 'STANDARD', start: 'Jul 12', end: 'Jul 25', days: 14, budget: 52090, completed: false, notes: '' },
            { wbs: '7.3', task: 'House Wrap & Dry-In (Weather-Tight)', type: 'STANDARD', start: 'Jul 26', end: 'Aug 1', days: 7, budget: 20000, completed: false, notes: '' },
            
            { wbs: '8', task: 'MEP ROUGH-INS (Electrical, Plumbing, HVAC)', type: 'STANDARD', start: 'Jul 28', end: 'Aug 14', days: 18, budget: 116800, isSection: true, completed: false, notes: '' },
            { wbs: '8.1', task: 'Electrical Rough-In', type: 'STANDARD', start: 'Jul 28', end: 'Aug 8', days: 12, budget: 35600, completed: false, notes: '' },
            { wbs: '8.2', task: 'Plumbing Rough-In', type: 'STANDARD', start: 'Jul 28', end: 'Aug 8', days: 12, budget: 41100, completed: false, notes: '' },
            { wbs: '8.3', task: 'HVAC Rough-In', type: 'STANDARD', start: 'Jul 28', end: 'Aug 8', days: 12, budget: 40100, completed: false, notes: '' },
            { wbs: '8.4', task: 'All Rough-In Inspections', type: 'CRITICAL', start: 'Aug 11', end: 'Aug 11', days: 1, budget: 0, completed: false, notes: '' },
            { wbs: '8.5', task: '‚úÖ Framing Inspection - MAJOR MILESTONE', type: 'MILESTONE', start: 'Aug 14', end: 'Aug 14', days: 1, budget: 0, completed: false, notes: '' },
            
            { wbs: '9', task: 'POOL & OUTDOOR FEATURES', type: 'STANDARD', start: 'Jun 23', end: 'Aug 28', days: 67, budget: 42500, isSection: true, completed: false, notes: '' },
            { wbs: '9.1', task: 'Pool Permit Submission & Approval', type: 'CRITICAL', start: 'Jun 10', end: 'Jun 20', days: 11, budget: 0, completed: false, notes: '' },
            { wbs: '9.2', task: 'Pool Excavation & Steel Installation', type: 'STANDARD', start: 'Jun 23', end: 'Jul 15', days: 23, budget: 18000, completed: false, notes: '' },
            { wbs: '9.3', task: 'Pool Gunite/Shotcrete Application', type: 'STANDARD', start: 'Jul 16', end: 'Jul 23', days: 8, budget: 12000, completed: false, notes: '' },
            { wbs: '9.4', task: 'Pool Plumbing & Equipment Install', type: 'STANDARD', start: 'Jul 24', end: 'Aug 8', days: 16, budget: 6500, completed: false, notes: '' },
            { wbs: '9.5', task: 'Pool Finish (Tile/Plaster)', type: 'STANDARD', start: 'Aug 9', end: 'Aug 20', days: 12, budget: 6000, completed: false, notes: '' },
            
            { wbs: '10', task: 'EXTERIOR FINISHES', type: 'STANDARD', start: 'Aug 2', end: 'Sep 5', days: 35, budget: 104740, isSection: true, completed: false, notes: '' },
            { wbs: '10.1', task: 'Roofing Installation', type: 'STANDARD', start: 'Aug 2', end: 'Aug 8', days: 7, budget: 35600, completed: false, notes: '' },
            { wbs: '10.2', task: 'Windows & Doors Installation', type: 'STANDARD', start: 'Aug 9', end: 'Aug 20', days: 12, budget: 42140, completed: false, notes: '' },
            { wbs: '10.3', task: 'Exterior Stucco/Siding', type: 'STANDARD', start: 'Aug 21', end: 'Sep 5', days: 16, budget: 27000, completed: false, notes: '' },
            
            { wbs: '11', task: 'INTERIOR FINISHES', type: 'STANDARD', start: 'Aug 15', end: 'Sep 25', days: 42, budget: 128670, isSection: true, completed: false, notes: '' },
            { wbs: '11.1', task: 'Insulation & Drywall', type: 'STANDARD', start: 'Aug 15', end: 'Aug 28', days: 14, budget: 28500, completed: false, notes: '' },
            { wbs: '11.2', task: 'Interior Painting', type: 'STANDARD', start: 'Aug 29', end: 'Sep 8', days: 11, budget: 6000, completed: false, notes: '' },
            { wbs: '11.3', task: 'Flooring Installation', type: 'STANDARD', start: 'Sep 9', end: 'Sep 18', days: 10, budget: 35670, completed: false, notes: '' },
            { wbs: '11.4', task: 'Kitchen Cabinets & Countertops', type: 'STANDARD', start: 'Sep 19', end: 'Sep 25', days: 7, budget: 28000, completed: false, notes: '' },
            { wbs: '11.5', task: 'Bathroom Fixtures & Finishes', type: 'STANDARD', start: 'Sep 19', end: 'Sep 25', days: 7, budget: 18500, completed: false, notes: '' },
            { wbs: '11.6', task: 'Interior Trim & Doors', type: 'STANDARD', start: 'Sep 19', end: 'Sep 25', days: 7, budget: 12000, completed: false, notes: '' }
        ];


        // ===== AUTHENTICATION FUNCTIONS =====
        
        function showLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('signupForm').style.display = 'none';
            hideAuthError();
        }

        function showSignup() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
            hideAuthError();
        }

        function showAuthError(message) {
            const errorDiv = document.getElementById('authError');
            errorDiv.textContent = message;
            errorDiv.classList.add('active');
        }

        function hideAuthError() {
            const errorDiv = document.getElementById('authError');
            errorDiv.classList.remove('active');
        }

        async function loginUser() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showAuthError('Please enter both email and password');
                return;
            }

            hideAuthError();
            showLoading();
            
            try {
                await auth.signInWithEmailAndPassword(email, password);
                // Auth state observer will handle UI updates
            } catch (error) {
                console.error('Login error:', error);
                hideLoading();
                showAuthError(getAuthErrorMessage(error.code));
            }
        }

        async function signupUser() {
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const passwordConfirm = document.getElementById('signupPasswordConfirm').value;
            
            if (!email || !password || !passwordConfirm) {
                showAuthError('Please fill in all fields');
                return;
            }
            
            if (password !== passwordConfirm) {
                showAuthError('Passwords do not match');
                return;
            }
            
            if (password.length < 6) {
                showAuthError('Password must be at least 6 characters');
                return;
            }

            hideAuthError();
            showLoading();
            
            try {
                await auth.createUserWithEmailAndPassword(email, password);
                // Auth state observer will handle UI updates
            } catch (error) {
                console.error('Signup error:', error);
                hideLoading();
                showAuthError(getAuthErrorMessage(error.code));
            }
        }

        async function logout() {
            if (confirm('Are you sure you want to logout?')) {
                try {
                    await auth.signOut();
                    // Auth state observer will handle UI updates
                } catch (error) {
                    console.error('Logout error:', error);
                    alert('Error logging out: ' + error.message);
                }
            }
        }

        function getAuthErrorMessage(code) {
            const messages = {
                'auth/email-already-in-use': 'Email already in use',
                'auth/invalid-email': 'Invalid email address',
                'auth/operation-not-allowed': 'Operation not allowed',
                'auth/weak-password': 'Password is too weak (min 6 characters)',
                'auth/user-disabled': 'User account has been disabled',
                'auth/user-not-found': 'No user found with this email',
                'auth/wrong-password': 'Incorrect password',
                'auth/invalid-credential': 'Invalid email or password',
                'auth/too-many-requests': 'Too many failed attempts. Please try again later.'
            };
            return messages[code] || 'An error occurred. Please try again.';
        }

        function showLoading() {
            document.getElementById('loadingOverlay').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        // Auth state observer - CRITICAL for site-wide authentication
        auth.onAuthStateChanged(async user => {
            hideLoading();
            
            if (user) {
                // User is signed in
                currentUser = user;
                document.getElementById('authModal').classList.remove('active');
                document.getElementById('mainContainer').style.display = 'block';
                document.getElementById('userInfo').classList.add('active');
                document.getElementById('userEmail').textContent = user.email;
                document.getElementById('syncIndicator').classList.add('active');
                console.log('User authenticated:', user.email);
                
                // Load saved data for team collaboration
                await loadFromFirebase(false);
                
                // Setup auto-save listeners
                setupAutoSaveListeners();
                
                // Setup real-time collaboration (optional)
                setupRealtimeSync();
                
                // Initial sync status
                updateSyncStatus('synced');
            } else {
                // User is signed out
                currentUser = null;
                document.getElementById('authModal').classList.add('active');
                document.getElementById('mainContainer').style.display = 'none';
                document.getElementById('userInfo').classList.remove('active');
                document.getElementById('syncIndicator').classList.remove('active');
                console.log('User not authenticated');
            }
        });

        // Tab Management
        function showTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabId).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Initialize project table
        function initProjectTable() {
            const tbody = document.getElementById('projectTableBody');
            tbody.innerHTML = '';
            
            projectData.forEach((item, index) => {
                const row = document.createElement('tr');
                row.className = `task-row ${item.isSection ? 'section' : ''} ${item.completed ? 'completed' : ''}`;
                
                const badgeClass = item.type === 'MILESTONE' ? 'badge-milestone' : 
                                  item.type === 'CRITICAL' ? 'badge-critical' : 
                                  'badge-standard';
                
                row.innerHTML = `
                    <td class="center">
                        ${!item.isSection ? `<input type="checkbox" class="task-checkbox" ${item.completed ? 'checked' : ''} onchange="toggleTask(${index})">` : ''}
                    </td>
                    <td><strong>${item.wbs}</strong></td>
                    <td class="task-name">${item.task}</td>
                    <td><span class="badge ${badgeClass}">${item.type}</span></td>
                    <td>${item.start}</td>
                    <td>${item.end}</td>
                    <td class="center">${item.days}</td>
                    <td class="right">$${item.budget.toLocaleString()}</td>
                    <td>
                        <textarea class="task-notes" placeholder="Add notes..." onchange="updateNotes(${index}, this.value)">${item.notes}</textarea>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            updateProgress();
        }

        function toggleTask(index) {
            projectData[index].completed = !projectData[index].completed;
            initProjectTable();
            triggerAutoSave(); // Auto-save when task is toggled
        }

        function updateNotes(index, notes) {
            projectData[index].notes = notes;
            triggerAutoSave(); // Auto-save when notes are updated
        }

        function updateProgress() {
            const completed = projectData.filter(item => item.completed).length;
            const total = projectData.length;
            const percentage = Math.round((completed / total) * 100);
            
            const progressBar = document.getElementById('projectProgress');
            progressBar.style.width = percentage + '%';
            progressBar.textContent = percentage + '% Complete';
        }

        // Firebase Functions
        // ===== COMPREHENSIVE DATA SYNC FOR TEAM COLLABORATION =====
        
        let saveTimeout = null;
        let isSyncing = false;

        // Comprehensive project data structure
        function gatherAllProjectData() {
            return {
                // Project metadata
                projectName: 'DERA Residence - 791 110th Ave N, Naples, FL',
                lastModified: new Date().toISOString(),
                modifiedBy: currentUser ? currentUser.email : 'unknown',
                
                // Task data from detailed project plan
                tasks: projectData,
                
                // Bid tracking data (if exists)
                bids: gatherBidData(),
                
                // Any custom notes or changes across tabs
                customNotes: gatherCustomNotes(),
                
                // Project settings
                settings: {
                    totalBudget: 697835,
                    startDate: 'Feb 15, 2025',
                    completionDate: 'Aug 2025'
                }
            };
        }

        function gatherBidData() {
            // Collect any bid tracking data from the Bid Tracking tab
            const bids = [];
            // This can be extended as bid tracking functionality grows
            return bids;
        }

        function gatherCustomNotes() {
            // Collect any custom notes from various tabs
            const notes = {};
            // Can be extended to capture tab-specific notes
            return notes;
        }

        async function saveToFirebase(showAlert = true) {
            if (!currentUser) {
                console.log('No user authenticated, skipping save');
                return;
            }
            
            if (isSyncing) {
                console.log('Sync already in progress');
                return;
            }

            isSyncing = true;
            updateSyncStatus('syncing');
            
            try {
                const projectData = gatherAllProjectData();
                
                // Save to shared project document for team collaboration
                await db.collection('projects').doc('dera-residence').set({
                    ...projectData,
                    lastUpdated: firebase.firestore.FieldValue.serverTimestamp(),
                    lastModifiedBy: currentUser.email,
                    collaborators: firebase.firestore.FieldValue.arrayUnion(currentUser.email)
                }, { merge: true });
                
                updateSyncStatus('synced');
                console.log('‚úÖ Data synced to cloud');
                
                if (showAlert) {
                    showNotification('‚úÖ Changes saved to cloud', 'success');
                }
            } catch (error) {
                console.error('Error saving to Firebase:', error);
                updateSyncStatus('error');
                
                if (showAlert) {
                    showNotification('‚ùå Error saving: ' + error.message, 'error');
                }
            } finally {
                isSyncing = false;
            }
        }

        async function loadFromFirebase(showAlert = false) {
            if (!currentUser) {
                console.log('No user authenticated, skipping load');
                return;
            }
            
            showLoading();
            
            try {
                const doc = await db.collection('projects').doc('dera-residence').get();
                
                if (doc.exists) {
                    const data = doc.data();
                    
                    // Load task data
                    if (data.tasks) {
                        projectData.length = 0;
                        projectData.push(...data.tasks);
                        initProjectTable();
                    }
                    
                    // Load bid data
                    if (data.bids) {
                        loadBidData(data.bids);
                    }
                    
                    // Load custom notes
                    if (data.customNotes) {
                        loadCustomNotes(data.customNotes);
                    }
                    
                    updateSyncStatus('synced');
                    console.log('‚úÖ Data loaded from cloud');
                    
                    if (showAlert) {
                        showNotification('‚úÖ Project data loaded', 'success');
                    }
                    
                    // Show who last modified
                    if (data.lastModifiedBy) {
                        console.log(`Last modified by: ${data.lastModifiedBy}`);
                    }
                } else {
                    console.log('‚ÑπÔ∏è No saved data found in cloud');
                    if (showAlert) {
                        showNotification('‚ÑπÔ∏è No saved data found', 'info');
                    }
                }
            } catch (error) {
                console.error('Error loading from Firebase:', error);
                updateSyncStatus('error');
                
                if (showAlert) {
                    showNotification('‚ùå Error loading: ' + error.message, 'error');
                }
            } finally {
                hideLoading();
            }
        }

        function loadBidData(bids) {
            // Load bid tracking data (to be implemented as bid tracking grows)
            console.log('Loading bid data:', bids);
        }

        function loadCustomNotes(notes) {
            // Load custom notes (to be implemented as note-taking grows)
            console.log('Loading custom notes:', notes);
        }

        // Auto-save with debouncing (saves 2 seconds after last change)
        function triggerAutoSave() {
            if (!currentUser) return;
            
            // Clear existing timeout
            if (saveTimeout) {
                clearTimeout(saveTimeout);
            }
            
            // Set new timeout
            saveTimeout = setTimeout(() => {
                saveToFirebase(false); // Auto-save without alert
            }, 2000); // 2 seconds after last change
        }

        // Update sync status indicator
        function updateSyncStatus(status) {
            const syncIndicator = document.getElementById('syncIndicator');
            if (!syncIndicator) return;
            
            switch(status) {
                case 'syncing':
                    syncIndicator.innerHTML = 'üîÑ Syncing...';
                    syncIndicator.style.color = '#f39c12';
                    break;
                case 'synced':
                    syncIndicator.innerHTML = '‚úÖ All changes saved';
                    syncIndicator.style.color = '#27ae60';
                    setTimeout(() => {
                        syncIndicator.innerHTML = '‚òÅÔ∏è Auto-sync enabled';
                        syncIndicator.style.color = '#3498db';
                    }, 2000);
                    break;
                case 'error':
                    syncIndicator.innerHTML = '‚ö†Ô∏è Sync error';
                    syncIndicator.style.color = '#e74c3c';
                    break;
                default:
                    syncIndicator.innerHTML = '‚òÅÔ∏è Auto-sync enabled';
                    syncIndicator.style.color = '#3498db';
            }
        }

        // Show notification (non-intrusive)
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                padding: 15px 25px;
                background: ${type === 'success' ? '#27ae60' : type === 'error' ? '#e74c3c' : '#3498db'};
                color: white;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 10000;
                animation: slideIn 0.3s ease;
                font-size: 0.9em;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Real-time listener for team collaboration (optional - enables real-time updates)
        function setupRealtimeSync() {
            if (!currentUser) return;
            
            // Listen for changes made by other team members
            db.collection('projects').doc('dera-residence')
                .onSnapshot((doc) => {
                    if (doc.exists) {
                        const data = doc.data();
                        
                        // Only update if modified by someone else
                        if (data.lastModifiedBy && data.lastModifiedBy !== currentUser.email) {
                            console.log(`üîÑ Update detected from ${data.lastModifiedBy}`);
                            
                            // Show notification that updates are available
                            showNotification(`üì¨ ${data.lastModifiedBy} made changes. Click "Refresh" to see updates.`, 'info');
                            
                            // Add refresh button to header
                            showRefreshButton();
                        }
                    }
                }, (error) => {
                    console.error('Real-time sync error:', error);
                });
        }

        function showRefreshButton() {
            const existingBtn = document.getElementById('refreshDataBtn');
            if (existingBtn) return; // Already showing
            
            const refreshBtn = document.createElement('button');
            refreshBtn.id = 'refreshDataBtn';
            refreshBtn.innerHTML = 'üîÑ Refresh Data';
            refreshBtn.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                padding: 12px 24px;
                background: #3498db;
                color: white;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-size: 0.9em;
                font-weight: 600;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 9999;
                animation: slideIn 0.3s ease;
            `;
            refreshBtn.onclick = async () => {
                await loadFromFirebase(true);
                refreshBtn.remove();
            };
            document.body.appendChild(refreshBtn);
        }

        // Setup auto-save listeners for ALL interactive elements
        function setupAutoSaveListeners() {
            console.log('üéØ Setting up auto-save listeners for all tabs');
            
            // Listen to ALL input changes across the entire page
            document.addEventListener('input', (e) => {
                if (e.target.matches('input, textarea, select')) {
                    console.log('üìù Change detected, triggering auto-save');
                    triggerAutoSave();
                }
            });
            
            // Listen to ALL checkbox changes
            document.addEventListener('change', (e) => {
                if (e.target.matches('input[type="checkbox"]')) {
                    console.log('‚úÖ Checkbox changed, triggering auto-save');
                    triggerAutoSave();
                }
            });
            
            // Listen to ALL clicks on interactive elements (in case of custom controls)
            document.addEventListener('click', (e) => {
                if (e.target.matches('button[data-save-trigger], .editable')) {
                    console.log('üñ±Ô∏è Interactive element clicked, triggering auto-save');
                    triggerAutoSave();
                }
            });
            
            console.log('‚úÖ Auto-save listeners active - all changes will be saved automatically');
        }

        async function saveToFirebase() {
            if (!currentUser) {
                showAuthModal();
                return;
            }
            
            try {
                await db.collection('projects').doc('dera-residence').set({
                    userId: currentUser.uid,
                    projectData: projectData,
                    lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                });
                alert('‚úÖ Project data saved to cloud successfully!');
            } catch (error) {
                console.error('Error saving to Firebase:', error);
                alert('‚ùå Error saving to cloud: ' + error.message);
            }
        }

        async function loadFromFirebase() {
            if (!currentUser) {
                showAuthModal();
                return;
            }
            
            try {
                const doc = await db.collection('projects').doc('dera-residence').get();
                if (doc.exists) {
                    const data = doc.data();
                    if (data.projectData) {
                        projectData.length = 0;
                        projectData.push(...data.projectData);
                        initProjectTable();
                        alert('‚úÖ Project data loaded from cloud successfully!');
                    }
                } else {
                    alert('‚ÑπÔ∏è No saved data found in cloud');
                }
            } catch (error) {
                console.error('Error loading from Firebase:', error);
                alert('‚ùå Error loading from cloud: ' + error.message);
            }
        }

        function exportToExcel() {
            // Simple CSV export
            let csv = 'WBS,Task,Type,Start,End,Days,Budget,Notes\n';
            projectData.forEach(item => {
                csv += `${item.wbs},"${item.task}",${item.type},${item.start},${item.end},${item.days},${item.budget},"${item.notes}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'dera-residence-project-plan.csv';
            a.click();
        }

        // Authentication Functions
        function showAuthModal() {
            document.getElementById('authModal').classList.add('active');
        }

        function hideAuthModal() {
            document.getElementById('authModal').classList.remove('active');
        }

        function showLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('signupForm').style.display = 'none';
        }

        function showSignup() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
        }

        function showAuthError(message) {
            const errorDiv = document.getElementById('authError');
            errorDiv.textContent = message;
            errorDiv.classList.add('active');
            setTimeout(() => {
                errorDiv.classList.remove('active');
            }, 5000);
        }

        async function loginUser() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                await auth.signInWithEmailAndPassword(email, password);
                hideAuthModal();
            } catch (error) {
                showAuthError(error.message);
            }
        }

        async function signupUser() {
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const passwordConfirm = document.getElementById('signupPasswordConfirm').value;
            
            if (password !== passwordConfirm) {
                showAuthError('Passwords do not match');
                return;
            }
            
            if (password.length < 6) {
                showAuthError('Password must be at least 6 characters');
                return;
            }
            
            try {
                await auth.createUserWithEmailAndPassword(email, password);
                hideAuthModal();
            } catch (error) {
                showAuthError(error.message);
            }
        }

        async function logout() {
            try {
                await auth.signOut();
            } catch (error) {
                console.error('Logout error:', error);
            }
        }

        // Auth state observer
        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                document.getElementById('userInfo').classList.add('active');
                document.getElementById('userEmail').textContent = user.email;
                loadFromFirebase();
            } else {
                currentUser = null;
                document.getElementById('userInfo').classList.remove('active');
            }
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initProjectTable();
        });
    </script>
</body>
</html>
